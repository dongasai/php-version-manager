# PVM Use 命令优化 - 交互选择功能

## 优化目标
优化 `pvm use` 命令，在没有指定版本时进入交互选择模式，而不是显示当前版本。

## 实现内容

### 1. 修改 UseCommand 类
- **文件**: `src/Console/Commands/UseCommand.php`
- **主要变更**:
  - 添加了 `ConsoleUI` 依赖用于交互界面
  - 修改 `execute` 方法，无参数时调用 `interactiveVersionSelection()` 方法
  - 新增 `interactiveVersionSelection()` 方法实现交互选择
  - 新增 `performVersionSwitch()` 方法处理版本切换
  - 新增 `getSimpleInstalledVersions()` 方法获取简单版本列表

### 2. 交互选择功能特性
- **版本选择**: 显示所有已安装的PHP版本供用户选择
- **当前版本标识**: 在版本列表中标识当前正在使用的版本
- **切换类型选择**: 提供三种切换类型：
  - 本地切换（仅当前会话）
  - 全局切换（永久）
  - 项目切换（当前目录）
- **退出支持**: 使用 `ConsoleUI::select()` 方法，支持 'q' 退出
- **智能提示**: 如果选择的是当前版本，会提示用户

### 3. 用户体验改进
- **友好提示**: 显示当前PHP版本信息
- **清晰选项**: 版本选项中标明当前版本
- **操作确认**: 提供操作取消和确认机制
- **错误处理**: 完善的异常处理和用户提示

### 4. 更新帮助文档
- 更新命令用法说明，明确指出无参数时进入交互模式
- 添加交互模式的详细说明
- 提供完整的使用示例

## 测试结果

### 基本功能测试
✅ **无参数调用**: `pvm use` 正确进入交互选择模式
✅ **版本显示**: 正确显示当前PHP版本和已安装版本列表
✅ **退出功能**: 输入 'q' 可以正常退出
✅ **当前版本检测**: 正确识别并提示当前版本
✅ **帮助功能**: `pvm use --help` 正确显示帮助信息
✅ **系统版本支持**: 系统PHP版本可以正常切换

### 交互流程测试
✅ **版本选择界面**: 清晰显示版本选项和退出选项
✅ **当前版本提示**: 选择当前版本时正确提示
✅ **操作取消**: 支持在各个步骤取消操作

### 兼容性测试
✅ **原有参数功能**: 带版本参数的命令正常工作
✅ **选项参数**: --global, --project 等选项正常工作

## 代码变更摘要

### UseCommand 类变更
**文件**: `src/Console/Commands/UseCommand.php`

#### 新增方法
1. `interactiveVersionSelection()` - 交互式版本选择主方法
2. `performVersionSwitch()` - 执行版本切换操作
3. `getSimpleInstalledVersions()` - 获取简化的版本列表

#### 修改方法
1. `execute()` - 修改无参数时的行为，添加帮助参数处理
2. `getUsage()` - 更新帮助文档

#### 依赖变更
- 新增 `VersionManager\Console\UI\ConsoleUI` 依赖

### VersionSwitcher 类变更
**文件**: `src/Core/VersionSwitcher.php`

#### 修改方法
1. `isVersionInstalled()` - 添加系统版本检查支持

#### 修复问题
- 修复了系统PHP版本无法被识别为已安装版本的问题

## 兼容性
- ✅ 保持原有命令行参数功能不变
- ✅ 向后兼容所有现有用法
- ✅ 新增功能不影响现有脚本

## 后续优化建议
1. 考虑添加版本搜索功能（当版本较多时）
2. 可以考虑添加版本详细信息显示
3. 支持批量操作（如果需要）

## 总结
成功实现了 `pvm use` 命令的交互选择功能，提升了用户体验，使版本切换更加直观和便捷。用户现在可以通过简单的 `pvm use` 命令进入友好的交互界面来选择和切换PHP版本。
