#!/usr/bin/env php
<?php

// 确保在CLI环境中运行
if (PHP_SAPI !== 'cli') {
    echo 'Warning: PVM should be run in a Command Line Interface.' . PHP_EOL;
    exit(1);
}

// 自动加载
$autoloadPaths = [
    __DIR__ . '/../vendor/autoload.php',
    __DIR__ . '/../../../autoload.php',
];

$loaded = false;
foreach ($autoloadPaths as $file) {
    if (file_exists($file)) {
        require $file;
        $loaded = true;
        break;
    }
}

if (!$loaded) {
    echo 'You need to set up the project dependencies using Composer:' . PHP_EOL . PHP_EOL;
    echo '    composer install' . PHP_EOL . PHP_EOL;
    echo 'You can learn all about Composer on https://getcomposer.org/.' . PHP_EOL;
    exit(1);
}

// 引导应用程序
try {
    $app = new VersionManager\Console\Application();
    $exitCode = $app->run($argv);
    exit($exitCode);
} catch (Exception $e) {
    echo 'Error: ' . $e->getMessage() . PHP_EOL;
    exit(1);
}
